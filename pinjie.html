<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>账单图片拼接工具</title>
    <script src="https://cdn.tailwindcss.com/3.3.3"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
    <link rel="stylesheet" href="css/pstyle.css">
</head>
<body class="min-h-screen">
    <!-- 下载头部 -->
    <div id="downloadHeader" class="download-header hidden">
        <div class="container mx-auto px-4 flex justify-between items-center">
            <div class="text-lg font-semibold">
                <i class="fas fa-image mr-2"></i>拼接结果
            </div>
            <button id="downloadBtn" class="btn-primary px-6 py-2 rounded-lg text-base">
                <i class="fas fa-download mr-1"></i>下载图片
            </button>
        </div>
    </div>

    <div class="container mx-auto px-4 py-10">
        <!-- 标题区域 -->
        <div class="text-center mb-12">
            <h1 class="text-4xl font-bold text-blue-700 mb-5">账单图片拼接工具</h1>
            <p class="text-lg text-gray-700 max-w-3xl mx-auto">轻松将多张账单图片拼接成长图，并添加结算信息</p>
        </div>

        <!-- 主体布局 - 电脑端横向三栏，移动端垂直 -->
        <div class="desktop-layout flex flex-col lg:flex-row gap-6">
            <!-- 上传区域 -->
            <div class="glass-card p-6 flex-1">
                <h2 class="text-2xl font-semibold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-upload text-blue-500 mr-3 text-xl"></i>
                    上传账单图片
                </h2>
                
                <div id="dropzone" class="dropzone rounded-lg p-8 text-center cursor-pointer mb-6">
                    <div class="flex flex-col items-center justify-center">
                        <i class="fas fa-cloud-upload-alt text-4xl text-blue-400 mb-4"></i>
                        <p class="text-lg text-gray-600 mb-2">拖拽图片到此处或点击选择文件</p>
                        <p class="text-sm text-gray-500">支持JPG、PNG格式，最多可上传15张图片</p>
                    </div>
                    <input type="file" id="fileInput" class="hidden" accept="image/*" multiple>
                </div>
                
                <button id="uploadBtn" class="btn-primary w-full py-3 rounded-lg text-lg">
                    <i class="fas fa-upload mr-2"></i>选择图片
                </button>
                
                <div id="previewContainer" class="mt-6 grid grid-cols-3 gap-3 hidden">
                    <h3 class="col-span-3 text-xl font-medium text-gray-700 mb-3">已上传图片预览</h3>
                    <div id="fileInfo" class="col-span-3 file-info hidden">
                        已上传 <span id="uploadedCount" class="file-count">0</span>/<span class="file-count">15</span> 张图片
                    </div>
                </div>
            </div>

            <!-- 结算信息区域 -->
            <div class="glass-card p-6 flex-1">
                <h2 class="text-2xl font-semibold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-cog text-blue-500 mr-3 text-xl"></i>
                    结算信息设置
                </h2>
                
                <div class="space-y-6">
                    <div class="tag-style">
                        <label class="info-label block mb-2">结算总金额</label>
                        <input type="text" id="amountInput" placeholder="请输入结算金额" 
                               class="w-full px-4 py-2 rounded-lg border border-blue-200 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-base" 
                               inputmode="decimal" pattern="[0-9]*" onkeypress="return validateNumberKey(event)" 
                               oninput="validateAmountInput(this)">
                        <div id="amountError" class="text-red-500 text-xs mt-1 hidden">
                            <i class="fas fa-exclamation-circle mr-1"></i>请输入有效的数字
                        </div>
                    </div>
                    
                    <div class="tag-style relative">
                        <label class="info-label block mb-2">收款账号名称</label>
                        <div class="relative">
                            <input type="text" id="accountNameInput" placeholder="请输入收款账号名称" 
                                   class="w-full px-4 py-2 rounded-lg border border-blue-200 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-base pr-14">
                            <button id="copyAccountBtn" class="copy-btn absolute right-2 top-1/2 transform -translate-y-1/2 px-2 py-1 rounded text-sm">
                                <i class="fas fa-copy mr-1"></i>复制
                            </button>
                            <div id="copySuccess" class="copy-success">
                                <i class="fas fa-check mr-1"></i>已复制
                            </div>
                        </div>
                    </div>
                    
                    <!-- <div class="tag-style">
                        <label class="info-label block mb-2">收款二维码内容</label>
                        <input type="text" id="qrContentInput" placeholder="请输入二维码内容（如收款链接）" 
                               class="w-full px-4 py-2 rounded-lg border border-blue-200 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-base mb-3">
                        <div id="qrCodePreview" class="flex justify-center p-3 rounded-lg hidden"> -->
                            <!-- 二维码将在这里生成 -->
                        <!-- </div>
                    </div> -->

                    <!-- 自定义二维码上传区域 -->
                    <div class="tag-style">
                        <label class="info-label block mb-2">上传自定义二维码</label>
                        <div id="customQrDropzone" class="dropzone rounded-lg p-4 text-center cursor-pointer mb-3">
                            <div class="flex flex-col items-center justify-center">
                                <i class="fas fa-qrcode text-2xl text-blue-400 mb-2"></i>
                                <p class="text-gray-600 mb-1">拖拽二维码图片到此处或点击选择文件</p>
                                <p class="text-xs text-gray-500">支持JPG、PNG格式</p>
                            </div>
                            <input type="file" id="customQrInput" class="hidden" accept="image/*">
                        </div>
                        <div id="customQrPreview" class="hidden">
                            <p class="text-xs text-gray-600 mb-1">已上传自定义二维码：</p>
                            <div class="flex items-center">
                                <img id="customQrImage" class="w-20 h-20 border border-gray-200 rounded-lg mr-2">
                                <button id="removeCustomQrBtn" class="text-red-500 hover:text-red-700 text-sm">
                                    <i class="fas fa-trash-alt mr-1"></i>移除
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 拼接设置区域 -->
            <div class="glass-card p-6 flex-1">
                <h2 class="text-2xl font-semibold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-sliders-h text-blue-500 mr-3 text-xl"></i>
                    拼接设置
                </h2>
                
                <div class="space-y-6">
                    <!-- 背景选择区域 -->
                    <div class="tag-style">
                        <h3 class="info-label block mb-3">选择背景样式</h3>
                        <div class="grid grid-cols-3 gap-3">
                            <div class="cursor-pointer" onclick="selectBackground('default')">
                                <div id="bg-default" class="h-16 rounded-lg bg-white border-2 border-blue-500 flex items-center justify-center">
                                    <span class="text-xs">纯白背景</span>
                                </div>
                            </div>
                            <div class="cursor-pointer" onclick="selectBackground('pattern2')">
                                <div id="bg-pattern2" class="h-16 rounded-lg bg-pattern-2 border-2 border-transparent hover:border-blue-500 flex items-center justify-center">
                                    <span class="text-xs text-white">蓝紫渐变</span>
                                </div>
                            </div>
                            <div class="cursor-pointer" onclick="selectBackground('pattern3')">
                                <div id="bg-pattern3" class="h-16 rounded-lg bg-pattern-3 border-2 border-transparent hover:border-blue-500 flex items-center justify-center">
                                    <span class="text-xs">几何图形</span>
                                </div>
                            </div>
                            <div class="cursor-pointer" onclick="selectBackground('pattern4')">
                                <div id="bg-pattern4" class="h-16 rounded-lg bg-pattern-4 border-2 border-transparent hover:border-blue-500 flex items-center justify-center">
                                    <span class="text-xs">网格线</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-4 rounded-lg border border-blue-100 bg-blue-50/30">
                        <h3 class="font-semibold text-blue-800 text-lg mb-3">拼接方向</h3>
                        <div class="flex items-center space-x-6">
                            <div>
                                <label class="inline-flex items-center">
                                    <input type="radio" name="direction" value="vertical" checked class="text-blue-600 h-4 w-4">
                                    <span class="ml-2 text-base">垂直拼接</span>
                                </label>
                            </div>
                            <div>
                                <label class="inline-flex items-center">
                                    <input type="radio" name="direction" value="horizontal" class="text-blue-600 h-4 w-4">
                                    <span class="ml-2 text-base">水平拼接</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <button id="generateBtn" class="btn-primary w-full py-3 rounded-lg text-lg">
                        <i class="fas fa-magic mr-2"></i>生成拼接图片
                    </button>
                </div>
            </div>
        </div>

        <!-- 结果展示区域 -->
        <div id="resultContainer" class="glass-card p-6 mt-8 hidden">
            <div class="save-hint mb-4">
                <i class="fas fa-info-circle text-blue-500 mr-2"></i>
                长按图片可保存到相册
            </div>
            
            <div id="resultCanvasContainer" class="flex justify-center">
                <canvas id="resultCanvas" class="max-w-full border border-gray-200 rounded-lg shadow-md"></canvas>
            </div>
        </div>
    </div>

    <footer class="bg-gray-50 py-6 mt-12">
        <div class="container mx-auto px-4 text-center text-gray-500 text-sm">
            <p>created by <a href="https://space.coze.cn" class="text-blue-500 hover:underline">coze space</a></p>
            <p class="mt-1">页面内容均由含光 + AI 生成，仅供学习交流</p>
        </div>
    </footer>

    <script src="js/pscript.js"></script>
  </body>
</html>
